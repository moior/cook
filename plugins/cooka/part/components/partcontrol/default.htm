
<style>
    .table td, .table th {font-size:10pt;}

    /*좌우로쫙 이미지 펼치기*/
    .justify-image{ text-align: justify;}
    .justify-image figure {display:inline-block;}
    .justify-image:after{content:""; display: inline-block; width: 100%; height: 0;}

    .thumbnail-wrapper{
        max-width: 24%;
        height: 150px;
        overflow: hidden;
        position:relative;
        margin:0px;
    }
    figcaption {text-align:center;        background-color:#e3e3e3;
    }

    .sample_image {
        max-width: 100%;
        max-height: 127px;
        height: auto;

    }


</style>

<script>
function form새부품체크() { /*폼 넘기기 전 실행*/
    if(  $("#input부품가격").val()  ) {
        $("#form새부품").submit();
    }
}
$(document).ready(function(){

    var isMobile = true;
    if($(window).innerWidth() >= 760) {
        isMobile = false;
    }
    /*따라다니는 메뉴*/
    if(isMobile == false){
    }

    $(".each부품").dblclick(function(){
        $("#table부품정보수정 input").val("");
        //$("#table부품정보수정 input[name=title]").val( $(this).find(".td제목").text()  );
        //$("#table부품정보수정 input[name=name]").val( $(this).find(".td이름").text()  );
        $("#table부품정보수정 input[name=key0]").val( $("#td키0").text()  );
        $("#table부품정보수정 input[name=key1]").val( $(this).find(".td키1").text()  );
        $("#table부품정보수정 input[name=key2]").val( $(this).find(".td키2").text()  );
        $("#table부품정보수정 input[name=key3]").val( $(this).find(".td키3").text()  );
        $("#table부품정보수정 input[name=qtnum]").val( $(this).find(".td기준수량").text()  );
        $("#table부품정보수정 input[name=value]").val( $(this).find(".td가격").text()  );
        $("#table부품정보수정 input[name=comment]").val( $(this).find(".td코멘트").text()  );
        $("#table부품정보수정 input[name=ord]").val( $(this).data("ord")  );
        $("#table부품정보수정 input[name=part_id]").val( $(this).data("part_id")  ); // edit, del 폼에 둘다 들어감
        $("#table부품정보수정").show().insertAfter( $(this) );
    });
    $("#btn부품삭제").click(function(){
        if(confirm("부품 하나를 삭제합니다")){
            $("#form부품정보삭제").submit();
        }
    })
})
</script>
<div class="justify-image">

    <h5>부품
        <small style="font-size:0.4em;">더블클릭 > 시세에 맞게 변경해주세요.
            <a class="btn btn-link btn-xs" href="javascript:$('#div도움말').toggle();">도움말</a>
        </small>
    </h5>
    <div id="div도움말" style="display:none;">
        <ul style="padding-left:0px;font-size:11pt;">
            <li>
                <b>제본방식의 경우</b>
                <ul style="padding-left:10px;font-size:10pt;">
                    <li>기본비는 1권을 제작하더라도 무조건 드는 비용입니다.</li>
                    <li>100권일때의 제본가격을 입력해두면, 50권 주문시 기본비와 100권 사이를 자동 계산해서 출렵합니다.</li>
                    <li>같은 방식으로 1000권일때의 제본가격을 입력해두면, 500권 주문시 그 차이를 자동 계산합니다.</li>
                    <li>가장 큰 기준인 1000권을 넘어갈 경우, 초과수량 가격을 권수마다 자동계산합니다.</li>
                    <li>혹 300권, 5000권 등 다른 기준이 필요한경우에는 유선연락주세요.</li>
                    <li>내지가 두꺼운 경우(100장이 넘어가면) 작업이 난해해지므로 수량에 따른 할증이 있습니다...
                        (이부분 아직 완벽하지 않음)</li>
                </ul>

            </li>
            <li><b>용지의 경우</b>
                <ul style="padding-left:10px;font-size:10pt;">
                    <li>내부 계산할때 쓰이는 데이터이므로 자유롭게 입력해도 됩니다. </li>
                    <li>실제 구입하는 가격에서 약간 높여 기입해주세요. (이익은 '작업비' 항목으로 충분히 받읍시다.)</li>
                    <li>g수가 없는 항목(예, 국전 아트)이 필요할때가 있습니다. g수에 연연해하지 않는 고객이 아트지로 해주세요. 라고 했을떄 적절히 골라서 쓸 수 있는 가격으로 책정해주세요.</li>
                    <li>입력한 항목이 자동계산기(오른쪽)에서 자동으로 나오지는 않습니다. 계산기에 반영하려면 따로 연락주세요!</li>
                    <li>특수지아직입니다. 통상 쓰이는 특수지 가격을 적어주세요..</li>
                </ul>
            </li>
            <li><b>인쇄의 경우</b>
                <ul style="padding-left:10px;font-size:10pt;">
                    <li>인쇄는 100권 이하일 경우 디지털인쇄, 넘어갈 경우 옵셋입니다.</li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                </ul></li>
        </ul>
    </div>
    <div>
        <!--<a class="btn btn-default btn-xs" onclick="location.href='?all=true'">모두</a>-->
        <a class="btn btn-default btn-xs" onclick="location.href='?key0=제본&key1=무선'">제본-무선</a>
        <a class="btn btn-default btn-xs" onclick="location.href='?key0=제본&key1=스프링'">제본-스프링</a>
        <a class="btn btn-default btn-xs" onclick="location.href='?key0=제본&key1=중철'">제본-중철</a>
        <a class="btn btn-default btn-xs" onclick="location.href='?key0=제본&key1=양장'">제본-양장</a>
        <a class="btn btn-default btn-xs" onclick="location.href='?key0=용지&key1=국전'">용지-국전</a>
        <a class="btn btn-default btn-xs" onclick="location.href='?key0=용지&key1=46절'">용지-46절</a>

        <a class="btn btn-default btn-xs" onclick="location.href='?key0=인쇄&key1=오프셋'">오프셋</a>
        <a class="btn btn-default btn-xs" onclick="location.href='?key0=인쇄&key1=디지털'">디지털</a>
        <a class="btn btn-default btn-xs" onclick="location.href='?key0=작업비'">작업비</a>
        <a class="btn btn-default btn-xs" onclick="location.href='?key0=합지'">합지</a>
        <a class="btn btn-default btn-xs" onclick="location.href='?key0=싸바리'">싸바리</a>
        <a class="btn btn-default btn-xs" onclick="location.href='?key0=코팅'">코팅</a>

        <!--
        <a class="btn btn-default btn-xs" onclick="location.href='?title=인쇄'">인쇄</a>
        <a class="btn btn-default btn-xs" onclick="location.href='?title=박'">박</a>
        <a class="btn btn-default btn-xs" onclick="location.href='?title=합지'">합지</a>
        <a class="btn btn-default btn-xs" onclick="location.href='?title=라벨스틱'">라벨스틱</a>
        <a class="btn btn-default btn-xs" onclick="location.href='?title=라운딩'">라운딩</a>
        <a class="btn btn-default btn-xs" onclick="location.href='?title=포장'">포장</a>
        <a class="btn btn-default btn-xs" onclick="location.href='?title=디자인'">디자인</a>
        <a class="btn btn-default btn-xs" onclick="location.href='?title=배송'">배송</a>
        -->
    </div>
    <style>
        .td제목 {width:5%;}
        .td이름 {width:10%;}
        .td키1 {width:15%;}
        .td키2 {width:15%;}
        .td키3 {width:10%;}
        .td기준수량 {width:10%;}
        .td가격 {width:15%;}
        .td가격 input {text-align:right;}
    </style>

    <div style="padding:5px;font-weight:bold;font-size:15px;">
        <span id="td키0">대분류 : {{ request.key0 }} </span>
    </div>

    <table id="" class="table table-condensed  ">
    <tr>
        <td>
            <table style="width:100%;">
                <th class="td제목">분류</th>

                <th class="td키1" style="">1분류</th>
                <th class="td키2" style="">2분류</th>
                <th class="td키3" style="">3분류</th>
                <th class="td기준수량" style="">기준수량</th>
                <th class="td가격" style="">가격(수치)</th>
            </table>
        </td>

    </tr>

    {% for part in parts %}
        <tr>
            <td>
            <table style="width:100%;" class="each부품"
                    data-ord="{{ part.ord }}"
                    data-part_id="{{ part.id }}">
            <tr class="tr부품">
                <td class="td제목"><small style="color:#bcbcbc;">{{ part.ord }}</small>
                    <!--<span class="td제목">{{ part.title }}</span>--></td>
                <td class="td키1">{{ part.key1 }}</td>
                <td class="td키2">{{ part.key2 }}</td>
                <td class="td키3">{{ part.key3 }}</td>
                <td class="td기준수량">{{ part.qtnum }}</td>
                <td class="td가격" style="text-align:right;">{{ part.value|number_format }}</td>
            </tr>
            <tr class="tr부품" data-part_id="{{ part.id }}">
                <td></td>
                <td colspan="6" class="td코멘트"><small>{{ part.comment }}</small></td>
            </tr>

            </table>
            </td>
        </tr>
    {% endfor %}
    </table>

    {% if not parts %}
    <div style="text-align:center;margin:150px 0;">카테고리를 골라주세요</div>
    {% endif %}

    <div id="table부품정보수정" style="position:absolute;display:none;">
        {{ form_ajax('PartControl::onEditPart',{
        id: "form부품정보수정",
        success :"$(\"<div style='position:absolute;font-size:20px;padding:10px;bottom:0px;left:0px;width:100%;text-align:center;background-color:gold;color:gray;z-index:99999;' >저장되었습니다.</div>\").insertBefore('#form부품정보수정').fadeOut(2500);",
        }) }}
        <input type="hidden" name="part_id" value="" />
        <table class="table table-condensed" style="background-color:#d6d6d3;margin-bottom:1px;">
            <tr class="">
                <td ><b>정보수정</b></td>
                <td colspan="2" class="text-right">
                    <a class="btn btn-default btn-xs" onclick="$('#table부품정보수정').hide();">닫기</a>
                    <button type="submit" class="btn btn-primary btn-xs" id="btn부품수정">수정</button>
                </td>
            </tr>
            <tr class="">
                <!--<td><input type="text" name="title" value="" class="form-control input-sm" placeholder="분류" /></td>-->
                <!--<td><input type="text" name="name" value="" class="form-control input-sm" placeholder="이름" /></td>-->
            <tr class="" style="">
                <td>*대분류 <input type="text" name="key0" value="" class="form-control input-sm" placeholder="큰분류" /></td>
                <td>*1차분류 <input type="text" name="key1" value="" class="form-control input-sm" placeholder="1차분류" /></td>
                <td>*2차분류 <input type="text" name="key2" value="" class="form-control input-sm" placeholder="2차분류" /></td>
            </tr>
            <tr>
                <td>3차분류 <input type="text" name="key3" value="" class="form-control input-sm" placeholder="3차분류" /></td>
                <td>*단위수량 <input type="text" name="qtnum" value="" class="form-control input-sm" placeholder="단위수량" /></td>

                <td>*가격 <input type="text" name="value" value="" class="form-control input-sm" placeholder="가격" /></td>

            </tr>
            <tr>
                <td>정렬순서 <input type="text" name="ord" value="" class="form-control input-sm" placeholder="순서"/></td>
                <td colspan="2">설명 <input type="text" name="comment" value="{{ part.comment }}" class="form-control input-sm" /></td>
            </tr>
        </table>
        {{ form_close() }}

        {{ form_ajax('PartControl::onDelPart',{
        id: "form부품정보삭제",
        success :"$(\"<div style='position:absolute;font-size:20px;padding:10px;bottom:0px;left:0px;width:100%;text-align:center;background-color:gold;color:gray;z-index:99999;'>삭제되었습니다.</div>\").insertBefore('#form부품정보수정').fadeOut(2500);",
        }) }}
        <div  style="background-color:#b9b9b6;padding:5px;">
            <input type="hidden" name="part_id" value="" />
            <button type="button" class="btn btn-link btn-xs" id="btn부품삭제">Del</button>
        </div>
        {{ form_close() }}
    </div>







    <div>
        <a class="btn btn-xs btn-default" id="btn부품추가" onclick="$('#div새부품추가').toggle();">
            + (SK만)
        </a>
    </div>
    <div id="div새부품추가" style="display:none;background-color:gold;padding:5px;" class="clearfix">

        {{ form_ajax('PartControl::onAddPart',{
        id: "form새부품",
        success :"alert('저장되었습니다. 새로고침하세요..')",
        }) }}
        <input type="hidden" name="cate" value="종이/노트"/>
        <input type="hidden" name="team_id" value="1"/>

        <!--<input type="text" name="title" value="" placeholder="분류 (ex:표지)" class="form-control"/>-->
        <!--<input type="text" name="name" value="" id="input부품이름" placeholder="제목/항목명 (ex:무선-A4-100권)"  class="form-control"/>-->
        <input type="text" name="key0" value="" placeholder="대분류 (ex:제본)" class="form-control"/>
        <input type="text" name="key1" value="" placeholder="1차분류 (ex:무선)" class="form-control"/>
        <input type="text" name="key2" value="" placeholder="2차분류 (ex:A4)" class="form-control"/>
        <input type="text" name="key3" value="" placeholder="3차분류 (필요시)" class="form-control"/>
        <input type="text" name="qtnum" value="" placeholder="기준수량 (ex:1000)" class="form-control"/>
        <input type="text" name="value" value="" id="input부품가격" placeholder="가격/수치"  class="form-control"/>
        <input type="text" name="ord" value="0" id="input노출순서" placeholder="정렬순서 (ex: 10) 낮으면 위에 나옴."  class="form-control"/>
        <input type="text" name="comment" value="" id="" placeholder="설명"  class="form-control"/>

        <small></small>
        <button type="button" onclick="return form새부품체크();" class="pull-right btn btn btn-primary" data-attach-loading>
            <span class="fa fa-pencil"></span> 저장
        </button>

        {{ form_close() }}

    </div>




</div>


